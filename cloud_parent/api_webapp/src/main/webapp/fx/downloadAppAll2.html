<!DOCTYPE html>  
<html>  
<head>  
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />  
     <script src="../assets/js/jquery/jquery.min.js"></script>
 <script src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
  <title>万心社Demo</title>  
</head>  
<body>  
<h1>iOS测试版安装 <a href="itms-services://?action=download-manifest&url=https://feifanxinli.com/assets/app/wxs//manifest.plist">万心社</a></h1>  
<br/>
<h1>iOS预生产安装 <a href="itms-services://?action=download-manifest&url=https://feifanxinli.com/assets/app/wxs/pre_manifest.plist">万心社-PRE</a></h1>
<br/>
<h1>iOS正式安装(RDS) <a href="itms-services://?action=download-manifest&url=https://feifanxinli.com/assets/app/wxs/pro_manifest.plist">万心社-PRE</a></h1>    

 <script language="javascript">
            window.onload = function() {
                var apiUrl = location.protocol+"//"+window.location.host+"/ffyy_api";
                locationUrl = apiUrl+"/fx/downloadAppAll2.html?";
     			wxtitle = "万心社APP版发布了，快来下载体验吧";
     			wximgUrl= apiUrl+"/assets/images/logo.png";
     			wxdesc = "如果没有安装成功，赶紧联系程序员小哥哥帮你诊断一下吧";
     			wxShare(apiUrl,locationUrl,wxtitle,wximgUrl,wxdesc);
     			
            };

//			微信分享
			function wxShare(apiUrl,locationUrl,wxtitle,wximgUrl,wxdesc){
				//分享配置
			    $.ajax({
			        type: "POST",
			        url : apiUrl+"/jssdk/get_config_param",
			        data: {requesUrl:location.href.split('#')[0]},
			        dataType:'json',
			        async:false,
			        success: function(data){
			        	console.log(data.code);
			            if(data.code == '2000'){
			                var appId = data.data.appId;
			                var timestamp = data.data.timestamp;
			                var nonceStr = data.data.nonceStr;
			                var signature = data.data.signature;
			    			console.log(appId)
			                wx.config({
			                    debug: false,  
			                    appId: appId,  
			                    timestamp: timestamp,  
			                    nonceStr: nonceStr,  
			                    signature: signature,  
			                    jsApiList: ['onMenuShareTimeline',
			                                'onMenuShareAppMessage',
			                                'onMenuShareQQ',
			                                'onMenuShareQZone']  
			                });  
			                wx.ready(function () {
			                    wx.checkJsApi({
			                        jsApiList: ['onMenuShareTimeline',
			                                    'onMenuShareAppMessage',
			                                    'onMenuShareQQ',
			                                    'onMenuShareQZone']  , 
			                        success: function(res) {
			                            console.log(JSON.stringify(res));
			                        }
			                    });
			                    //分享到朋友圈
			                    wx.onMenuShareTimeline({
			                        title: wxtitle, // 分享标题
			                        imgUrl: wximgUrl, // 分享图标
			                        desc: wxdesc, // 分享描述
			                        link:locationUrl,
			                        success: function () {},
			                        cancel: function () {}
			                    });
			                    //分享给朋友
			                    wx.onMenuShareAppMessage({
			                        title: wxtitle, // 分享标题
			                        imgUrl: wximgUrl, // 分享图标
			                        desc: wxdesc, // 分享描述
			                        link:locationUrl,
			                        success: function () {},
			                        cancel: function () {}
			                    });
			                    //分享到QQ
			                    wx.onMenuShareQQ({
			                        title: wxtitle, // 分享标题
			                        imgUrl: wximgUrl, // 分享图标
			                        desc: wxdesc, // 分享描述
			                        link:locationUrl,
			                        success: function () {},
			                        cancel: function () {}
			                    });
			                    //分享到QQ空间
			                    wx.onMenuShareQZone({
			                        title: wxtitle, // 分享标题
			                        imgUrl: wximgUrl, // 分享图标
			                        desc: wxdesc, // 分享描述
			                        link:locationUrl,
			                        success: function () {},
			                        cancel: function () {}
			                    });
			                    wx.error(function(res){
			                        //alert("errorMSG:"+res);
			                    });
			                });
			            }else{
			                alert(data.message);
			            }
			        },
			        error:function(response, status, err){
			            //alert("系统异常");
			        }
			    }); 
			}
        </script>
</body>  
</html>  